# RECOMMENDATIONS FOR LARGE DEPLOYMENTS
[[Tips]]

  Recommended undercloud and overcloud specifications and configuration for deploying a large Red Hat OpenStack Platform environment. Deployments of more than 50 overcloud nodes qualify as large environments.

##Recommended Specs

For best performance install undercloud on a physical server. If using virtualized undercloud ensure enough resources similar to physical machine.

  - Undercloud node
    - Count 1 
    - CPU 12c, 24 t
    - Disk 500GB root disk (1x ssd or 2x hd with 7200 RPM; RAID 1)
    - RAM 64 GB 
    - Network 10 Gbps
  
  - Controller nodes when using Ceph Storage nodes
    - Atleast 3 controllers nodes with all controller service contained within a single Controller role. If requied use composable services
    - CPU 2 socket with 12c, 24 t
    - Disk 500GB root disk (1x ssd or 2x hd with 7200 RPM; RAID 1)
    - RAM 128 GB 
    - Network 25 Gbps or 10 Gbps -- use network bonding to create 2 bonds
      - Provisioning (bond0 model 4); Internal API (bond0 - model4); Tenant (bond0 - model4)
      - Storage (bond1 - model4); Storage management(bond1 - mode4)
? what is network bonding 

  - Controller nodes when not using Ceph Storage nodes.
    - All similar to above specs except for additional setting in Disk
    - Disk 500GB root disk (1x ssd or 2x hd with 7200 RPM; RAID 1)
    - Disk 500GB disk for Swift (1x SSD or 2x HDD with 7200 RPM; RAID1)

  - Compute nodes
    - Counts Red Hat has tested a scale of 300 nodes
    - CPU same as Controller
    - Disk same as Controller 
    - RAM 128 GB (64GB per NUMA node); 2GB is reserved for host out of the box
    - Network same as Controller
? what is NUMA
  - Red Hat Ceph Storage nodes
    -  Counts:
       -  A min of 5 nodes with 3-way replication is required with all-flash configuration
       -  A min of 3 nodes with 2-way replication is required
? what is 3-way and 2-way replication

## Deployment Preparation considerataions [[Recommended deployment practices]]
  - Set root password for overcloud image
    - to allow console access to overcloud image
    - use console to troubleshoot failed Deployments when network is set *incorrectly*
    - use virt-customize 
    - ? what is `virt-customize`? 
 
  - Assign specific node IDs
    - use scheduler hints to assign hardware to a role such as controller, compute, cephstorage and others
    - ? what are `scheduler hints` ?  
    - scheduler hints allow for easier identification of deployment issues that affect only specific nodes
    - scheduler hints reduce load on nova-scheduler when implementing tag matching
    - *other benefits also*
    - Do not use profice tagging when using scheduler hints
    - ? what is `profile tagging`?
 
  - Set root disk hints
    -  when nodes contains multiple disks, introspection data to set the WWN as the root disk hint for each node.
  - Use OpenStack Bare Metal service (ironic) cleaning
  - Limit number of nodes for ironic introspection
  - Ceph Preparation

## Deployment Considersations
  - Validate the deployment command with small scale
  - Limit the number of nodes provisioned at the same time
  - Disable unused NICs
  - Power off unused ironic nodes
  
## Undercloud tuning considerataions
  - Increase keystone worker count
  - Increate response timeout of Heat API calls
  - Increase Keystone token timeout time
  - If telemetry is not used disable it
  
## Debugging TroubleshootingRHOSP13
  - Introspection Debugging
  - Deployment Debugging

  [[TroubleshootingRHOSP13]]

[//begin]: # "Autogenerated link references for markdown compatibility"
[Tips]: tips "Tips"
[Recommended deployment practices]: recommended-deployment-practices "Recommended Deployment Practices"
[TroubleshootingRHOSP13]: troubleshootingrhosp13 "TroubleshootingRHOSP13"
[//end]: # "Autogenerated link references"